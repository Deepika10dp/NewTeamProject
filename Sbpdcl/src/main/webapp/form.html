<!DOCTYPE html><html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Connection Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        html, body {
		    height: 100%;
		    margin: 0;
		    padding: 0;
		    font-family: 'Poppins', sans-serif;
		    background: url('https://images.unsplash.com/photo-1604079628040-fc720759f9a4?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
		    background-size: cover;
		    background-attachment: fixed;
		    overflow: hidden;
		}
        .form-wrapper {
            max-width: 1000px;
            margin: 50px auto;
            background-color: rgba(255, 255, 255, 0.97);
            padding: 50px 40px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
            animation: fadeIn 1s ease-in-out;
        }
        h2 {
            color: rgb(128,0,0);
            font-weight: 600;
        }
        label {
            font-weight: 500;
        }
        .btn-primary {
            background: linear-gradient(to right, #0066cc, #004080);
            border: none;
           
        }
        .btn-primary:hover {
            background: linear-gradient(to right, #004080, #002855);
        }
        input, select, textarea {
            transition: box-shadow 0.3s ease;
        }
        input:focus, select:focus, textarea:focus {
            box-shadow: 0 0 8px rgba(0, 102, 204, 0.4);
            border-color: #0066cc;
        }
        .text-danger {
            font-size: 0.9rem;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .form-control, .form-select {
            min-height: 45px;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        #previewSection {
            display: none;
        }
         .background-container {
		    min-height: 100vh;
		    display: flex;
		    align-items: center;
		    justify-content: center;
		    padding: 0; 
		}
	
	    .background-container::before {
	      content: "";
	      position: absolute;
	      top: 0; left: 0;
	      width: 100%; height: 100%;
	      background: url('images/3.jpg') no-repeat center center/cover;
	      filter: blur(8px);
	      z-index: -1;
	    }
	
	   .form-container {
		    background: rgba(255, 255, 255, 0.9);
		    max-width: 1000px;
		    margin: auto;
		    padding: 40px;
		    border-radius: 12px;
		    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
		}
	   .scroll-container {
		    position: absolute;
		    top: 0;
		    left: 0;
		    right: 0;
		    bottom: 0;
		    overflow-y: auto;
		    padding: 40px 20px;
		}
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
	<div class="background-container">
	<div class="scroll-container">
    <div class="container form-wrapper">
        <h2 class="text-center mb-4">New Connection Form</h2>
        <form id="connectionForm" action="NewConnectionServlet" method="post"  enctype="multipart/form-data" onsubmit="disableButton()">
        <p class="text-danger" style="text-align: center;">* Denotes Mandatory Fields (Please upload all documents in jpeg/jpg format. 
        Document size must be less than 200KB.). </p>
        <p class="text-danger" style="text-align: center;">Please refer to the guidelines for detailed information regarding payment.</p>
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="connectionType" class="form-label">Connection Type: <span class="text-danger">*</span></label>
                <select id="connectionType" name="connectionType" class="form-select" required>
                    <option value="">--Select--</option>
                    <option value="domestic">Domestic</option>
                    <option value="commercial">Commercial</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="consumerId" class="form-label">Consumer ID:<span class="text-danger">*</span></label>
                <input type="text" id="consumerId" name="consumerId"  class="form-control" placeholder="Enter Consumer ID" required>
            </div>
        </div>
	        <div class="row mb-3">
	            <div class="col-md-3">
	                <label for="mobile" class="form-label">Mobile No:<span class="text-danger">*</span></label>
	                <input type="text" id="mobile" name="mobile" class="form-control" placeholder="Enter Mobile No." required>
	            </div>
	            <div class="col-md-3">
	                <label for="email" class="form-label">Email ID:</label>
	                <input type="email" id="email" name="email" class="form-control" placeholder="Enter Email ID">
	            </div>
	        </div>
	        
        <h4>Address Details:</h4>
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="houseNo" class="form-label">House No:</label>
                <input type="text" id="houseNo" name="houseNo" class="form-control" placeholder="Enter House Number">
            </div>
            <div class="col-md-3">
                <label for="street" class="form-label">Street:<span class="text-danger">*</span></label>
                <input type="text" id="street" name="street" class="form-control" placeholder="Enter Street Name" required>
            </div>
             <div class="col-md-3">
               <label for="addressLine1" class="form-label">Address Line 1:</label>
           	   <input type="text" id="addressLine1" name="addressLine1" class="form-control" placeholder="Enter address" >
            </div>
        </div>
         <div class="row mb-3">
            <div class="col-md-3">
                 <label for="addressLine2" class="form-label">Address Line 2:</label>
            <input type="text" id="addressLine2" name="addressLine2" class="form-control" placeholder="Enter address" >
            </div>
            <div class="col-md-3">
               <label for="addressLine3" class="form-label">Address Line 3:</label>
            <input type="text" id="addressLine3" name="addressLine3" class="form-control" placeholder="Enter address" >
            </div>
            <div class="col-md-3">
               <label for="city" class="form-label">City:<span class="text-danger">*</span></label>
            <input type="text" id="city" name="city" class="form-control" placeholder="Enter City" required>
            </div>
        </div>
         <div class="row mb-3">
            <div class="col-md-3">
               <label for="pincode" class="form-label">Pin code:<span class="text-danger">*</span></label>
            <input type="text" id="pincode" name="pincode" class="form-control" placeholder="Enter Pin code" required>
            </div>
            <div class="col-md-3">
                 <label for="district" class="form-label">District:<span class="text-danger">*</span></label>
            <select id="district" name="district" class="form-select" required>
                <option value="">--Select--</option> 
            </select>
            </div>
            <div class="col-md-3">
                <label for="block" class="form-label">Block:<span class="text-danger">*</span></label>
            	<select id="block" name="block" class="form-select" required>
               		 <option value="">--Select--</option>           		
            	</select>
            </div>
        </div>
         <div class="row mb-3">          
            <div class="col-md-3">
                <label for="panchayat" class="form-label">Panchayat:<span class="text-danger">*</span></label>
           		 <select id="panchayat" name="panchayat" class="form-select" required>
		              <option value="">--Select--</option>		             
            	 </select>
            </div>
             <div class="col-md-3">
                <label for="village_ward" class="form-label">Village/Ward:<span class="text-danger">*</span></label>
	            <select id="village_ward" name="village_ward" class="form-select" required>
	                  <option value="">--Select--</option>	       
	            </select>
            </div>
			<div class="col-md-3">
			    <label for="division" class="form-label">Division:<span class="text-danger">*</span></label>
			    <select id="division" class="form-select" disabled style="pointer-events: none; background-color: #e9ecef;" required>
			        <option value="">--Select--</option>
			    </select>
			</div>
			<div class="col-md-3">
			    <label for="subdivision" class="form-label">SubDivision:<span class="text-danger">*</span></label>
			    <select id="subdivision" class="form-select" disabled style="pointer-events: none; background-color: #e9ecef;" required>
			        <option value="">--Select--</option>
			    </select>
			</div>
			<div class="col-md-3">
			    <label for="section" class="form-label">Section:<span class="text-danger">*</span></label>
			    <select id="section" class="form-select" disabled style="pointer-events: none; background-color: #e9ecef;" required>
			        <option value="">--Select--</option>
			    </select>
			</div>
			<input type="hidden" id="hiddenDivision" name="division" />
			<input type="hidden" id="hiddenSubdivision" name="subdivision" />
			<input type="hidden" id="hiddenSection" name="section" />
            <div class="col-md-3">
                <label for="tariff" class="form-label">Tariff:<span class="text-danger">*</span></label>
	            <select id="tariff" name="tariff" class="form-select" required>
	                <option value="">--Select--</option>
	                <option value="domestic">Domestic</option>
	                <option value="commercial">Commercial</option>
	                <option value="industrial">Industrial</option>
	            </select>
            </div>
        </div>
         <div class="row mb-3">          
            <div class="col-md-3">
                <label for="phase" class="form-label">Phase:<span class="text-danger">*</span></label>
	            <select id="phase" name="E_phase" class="form-select" required>
	                <option value="">--Select--</option>
	                <option value="single">Single</option>
	                <option value="three">Three</option>
	            </select>
            </div>
             <div class="col-md-3">
               <label for="load" class="form-label">Load:<span class="text-danger">*</span></label>
               <input type="text" id="load" name="E_load" class="form-control" placeholder="Enter load" required>
            </div>
        </div>
        
        <h4>Applicant Details:</h4>
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="gender" class="form-label">Gender <span class="text-danger">*</span></label>
                <select id="gender" name="gender" class="form-select" required>
                    <option value="">--Select--</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="applicantName" class="form-label">Applicant Name <span class="text-danger">*</span></label>
                <input type="text" id="applicantName" name="applicantName" class="form-control" placeholder="Enter Name" required>
            </div>
        </div>       
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="f_hName" class="form-label">Husband/Father Name <span class="text-danger">*</span></label>
                <input type="text" id="f_hName" name="f_hName" class="form-control" placeholder="Enter Father/Husband Name" required>
            </div>
        </div>
        
        <h4>ID Proof:</h4>
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="idProof" class="form-label">Document Type <span class="text-danger">*</span></label>
                <select id="idProof" name="idProof" class="form-select" required>
                    <option value="">---Select---</option>
                    <option value="passport">Passport</option>
                    <option value="pan_card">PAN Card</option>
                    <option value="aadhar_card">Aadhaar Card</option>
                    <option value="voter_id">Voter ID</option>
                    <option value="driving_license">Driving License</option>                    
                    <option value="ration_card">Ration Card</option>
					<option value="bpl_card">Below Poverty Line-BPL Card</option>
					<option value="id_government">ID Issued By Government</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="document_fileI" class="form-label"></label>
                <input type="file" id="document_fileI" name="documentFile" class="form-control" accept=".jpeg, .jpg"  >
            </div>
        </div>

        <h4>Address Proof:</h4>
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="addressProof" class="form-label">Document Type <span class="text-danger">*</span></label>
                <select id="addressProof" name="addressProof" class="form-select" required>
                    <option value="">---Select---</option>
                    <option value="passport">Passport</option>
                    <option value="pan_card">PAN Card</option>
                    <option value="aadhar_card">Aadhaar Card</option>
                    <option value="voter_id">Voter ID</option>
                    <option value="driving_license">Driving License</option>                    
                    <option value="ration_card">Ration Card</option>
                    <option value="id_government">ID Issued By Government</option>
					<option value="bpl_card">Bill of Government Landline Connection</option>					
                </select>
            </div>
            <div class="col-md-3">
                <label for="front_page" class="form-label">Front Page</label>
                <input type="file" id="front_page" name="frontPage" class="form-control" accept=".jpeg, .jpg" required>
            </div>
            <div class="col-md-3">
                <label for="last_page" class="form-label">Last Page</label>
                <input type="file" id="last_page" name="lastPage" class="form-control" accept=".jpeg, .jpg" required >
            </div>
        </div>
        
         <h4>Photo of Applicant:<span class="text-danger">*</span></h4>
        <div class="row mb-3">
            <div class="col-md-3">
                 <input type="file" id="photoApplicant" name="photo" class="form-control" accept="image/jpeg, image/jpg" required>
            </div>
        </div>
        
         <h4>Photo of Ownership(First page of Lease Deed/Rent Agreement/Others):<span class="text-danger">*</span></h4>
        <div class="row mb-3">
            <div class="col-md-3">
                <input type="file" id="photoOwnerFirst" name="photoOwnerFirst" class="form-control" accept="image/jpeg, image/jpg" required >
            </div>
        </div>
        
         <h4>Photo of Ownership(Second page of Lease Deed/Rent Agreement/Others):<span class="text-danger">*</span></h4>
        <div class="row mb-3">
            <div class="col-md-3">
                  <input type="file" id="photoOwnerSecond" name="photoOwnerSecond" class="form-control" accept="image/jpeg, image/jpg" required>
            </div>
        </div>
         <div class="text-center">
        <button type="submit" class="btn btn-primary">Submit</button>
	    </div>
	    </form>
	</div>
	</div>
	</div>

		<script>
		    $(document).ready(function () {
		        $.ajax({
		            url: "DivisionAutoFillServlet",
		            type: "POST",
		            data: { action: "getDistricts" },
		            dataType: "json",
		            success: function (data) {
		                $('#district').empty().append('<option value="">--Select District--</option>');
		                $.each(data, function (index, district) {
		                    $('#district').append('<option value="' + district.id + '">' + district.name + '</option>');
		                });
		            },
		            error: function (xhr, status, error) {
		                console.error("Error loading districts:", error);
		            }
		        });
		        
		        $('#district').change(function () {
		            let districtId = $(this).val();
		            clearDropdowns(['#block', '#panchayat', '#village_ward', '#division', '#subdivision', '#section']);
		            resetHiddenFields();
		
		            if (districtId) {
		                $.ajax({
		                    url: "DivisionAutoFillServlet?action=getBlocks&districtId=" + districtId,
		                    method: "POST",
		                    dataType: "json",
		                    success: function (response) {
		                      //  $('#block').append('<option value="">--Select Block--</option>');
		                        $.each(response, function (i, item) {
		                            $('#block').append('<option value="' + item.id + '">' + item.name + '</option>');
		                        });
		                    },
		                    error: function (xhr, status, error) {
		                        console.error("Error loading blocks:", error);
		                    }
		                });
		            }
		        });
	
		        $('#block').change(function () {
		            let blockId = $(this).val();
		            clearDropdowns(['#panchayat', '#village_ward', '#division', '#subdivision', '#section']);
		            resetHiddenFields();
		
		            if (blockId) {
		                $.ajax({
		                    url: "DivisionAutoFillServlet?action=getPanchayats&blockId=" + blockId,
		                    method: "POST",
		                    dataType: "json",
		                    success: function (response) {
		                       // $('#panchayat').append('<option value="">--Select Panchayat--</option>');
		                        $.each(response, function (i, item) {
		                            $('#panchayat').append('<option value="' + item.id + '">' + item.name + '</option>');
		                        });
		                    },
		                    error: function (xhr, status, error) {
		                        console.error("Error loading panchayats:", error);
		                    }
		                });
		            }
		        });
		
		        $('#panchayat').change(function () {
		            let panchayatId = $(this).val();
		            clearDropdowns(['#village_ward', '#division', '#subdivision', '#section']);
		            resetHiddenFields();

		            if (panchayatId) {
		                $.ajax({
		                    url: "DivisionAutoFillServlet?action=getVillages&panchayatId=" + panchayatId,
		                    method: "POST",
		                    dataType: "json", 
		                    success: function (response) {
		                       // $('#village_ward').append('<option value="">--Select Village/Ward--</option>');
		                        $.each(response, function (i, item) {
		                            $('#village_ward').append('<option value="' + item.id + '">' + item.name + '</option>');
		                        });
		                    },
		                    error: function (xhr, status, error) {
		                        console.error("Error loading villages:", error);
		                        alert("Error loading villages. Please try again.");
		                    }
		                });
		            }
		        });
		        $('#village_ward').change(function () {
		            let villageId = $(this).val();
		            clearDropdowns(['#division', '#subdivision', '#section']);
		            resetHiddenFields();
		
		            if (villageId) {
		                $.ajax({
		                    url: "DivisionAutoFillServlet?action=getHierarchy&villageId=" + villageId,
		                    method: "POST",
		                    dataType: "json",
		                    success: function (data) {
		                        $('#division').append('<option value="' + data.division.id + '" selected>' + data.division.name + '</option>');
		                        $('#hiddenDivision').val(data.division.id);
		                        $('#hiddenDivisionName').val(data.division.name);
		
		                        $('#subdivision').append('<option value="' + data.subdivision.id + '" selected>' + data.subdivision.name + '</option>');
		                        $('#hiddenSubdivision').val(data.subdivision.id);
		                        $('#hiddenSubdivisionName').val(data.subdivision.name);
		
		                        $('#section').append('<option value="' + data.section.id + '" selected>' + data.section.name + '</option>');
		                        $('#hiddenSection').val(data.section.id);
		                        $('#hiddenSectionName').val(data.section.name);
		                    },
		                    error: function (xhr, status, error) {
		                        console.error("Error loading hierarchy:", error);
		                    }
		                });
		            }
		        });
	
		        function clearDropdowns(ids) {
		            ids.forEach(function (id) {
		                $(id).empty().append('<option value="">--Select--</option>');
		            });
		        }
		
		        function resetHiddenFields() {
		            $('#hiddenDivision, #hiddenSubdivision, #hiddenSection, #hiddenDivisionName, #hiddenSubdivisionName, #hiddenSectionName').val('');
		        }
		
		        window.disableButton = function () {
		            document.getElementById('submitBtn').disabled = true;
		        };
		    });
		    
		    
		    const MAX_FILE_SIZE = 200 * 1024; // 200 KB
		    const ALLOWED_TYPES = ['image/jpeg', 'image/jpg'];

		    function validateFile(inputId) {
		        const input = document.getElementById(inputId);
		        input.addEventListener('change', function () {
		            const file = this.files[0];

		            if (file) {
		                // Check file size
		                if (file.size > MAX_FILE_SIZE) {
		                    alert("File size must be less than 200KB.");
		                    this.value = ""; // Clear the file input
		                    return;
		                }

		                // Check file type
		                if (!ALLOWED_TYPES.includes(file.type)) {
		                    alert("Only JPG/JPEG files are allowed.");
		                    this.value = ""; // Clear the file input
		                    return;
		                }
		            }
		        });
		    }

		    // Call this for each file input field
		    validateFile('document_fileI');
		    validateFile('front_page');
		    validateFile('last_page');
		    validateFile('photoApplicant');
		    validateFile('photoOwnerFirst');
		    validateFile('photoOwnerSecond');
		</script>
		

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	
</body>
</html>